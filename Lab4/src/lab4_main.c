// lab4_main.c
// Fur Elise, and Ice-cream truck song E155 Lab 4
//  noah Fotenos
// nfotenos@gmail.com
// 10/1/25

#include "STM32L432KC_TIM.h"
#include "STM32L432KC_RCC.h"
#include "STM32L432KC_GPIO.h"
#include "STM32L432KC_FLASH.h"

// Pitch in Hz, duration in ms
const int notes[][2] = {
{659,	125},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{494,	125},
{587,	125},
{523,	125},
{440,	250},
{  0,	125},
{262,	125},
{330,	125},
{440,	125},
{494,	250},
{  0,	125},
{330,	125},
{416,	125},
{494,	125},
{523,	250},
{  0,	125},
{330,	125},
{659,	125},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{494,	125},
{587,	125},
{523,	125},
{440,	250},
{  0,	125},
{262,	125},
{330,	125},
{440,	125},
{494,	250},
{  0,	125},
{330,	125},
{523,	125},
{494,	125},
{440,	250},
{  0,	125},
{494,	125},
{523,	125},
{587,	125},
{659,	375},
{392,	125},
{699,	125},
{659,	125},
{587,	375},
{349,	125},
{659,	125},
{587,	125},
{523,	375},
{330,	125},
{587,	125},
{523,	125},
{494,	250},
{  0,	125},
{330,	125},
{659,	125},
{  0,	250},
{659,	125},
{1319,	125},
{  0,	250},
{623,	125},
{659,	125},
{  0,	250},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{494,	125},
{587,	125},
{523,	125},
{440,	250},
{  0,	125},
{262,	125},
{330,	125},
{440,	125},
{494,	250},
{  0,	125},
{330,	125},
{416,	125},
{494,	125},
{523,	250},
{  0,	125},
{330,	125},
{659,	125},
{623,	125},
{659,	125},
{623,	125},
{659,	125},
{494,	125},
{587,	125},
{523,	125},
{440,	250},
{  0,	125},
{262,	125},
{330,	125},
{440,	125},
{494,	250},
{  0,	125},
{330,	125},
{523,	125},
{494,	125},
{440,	500},
{  0,	500},
{  0,   500},
{  0,   500}
};



int icecream[][2] = {
    {1047, 250}, // C6
    {932, 250}, // Bb5
    {831, 500}, // Ab5
    {831, 250}, // Ab5
    {932, 250}, // Bb5
    {831, 250}, // Ab5
    {622, 250}, // Eb5
    {523, 250}, // C5
    {554, 250}, // Db5
    {622, 250}, // Eb5
    {698, 250}, // F5

    {622, 250}, // Eb5
    {523, 250}, // C5
    {622, 500}, // Eb5
    {831, 250}, // Ab5
    {932, 250}, // Bb5
    {1047, 500}, // C6
    {1047, 500}, // C6
    {1047, 250}, // C6
    {932, 250}, // Bb5

    {831, 250}, // Ab5
    {932, 250}, // Bb5
    {1047, 500}, // C6
    {932, 500}, // Bb5
    {932, 500}, // Bb5
    {1047, 250}, // C6
    {932, 250}, // Bb5
    {831, 500}, // Ab5
    {831, 250}, // Ab5
    {932, 250}, // Bb5
    {831, 250}, // Ab5
    {622, 250}, // Eb5
    {523, 250}, // C5
    {554,250},  //Db5
    {622, 250}, // Eb5
    {698, 250}, // F5
    {622, 250}, // Eb5
    {523, 250}, // C5
    {622, 500}, // Eb5
    {831, 250}, // Ab5
    {932, 250}, // Bb5
    {1047, 250}, // C6
    {1044, 500}, // Eb6
    {1397,250}, //E6
    {1044, 250}, // Eb6 
    {1047, 250}, // C6
    {831, 250}, // Ab5
    {932, 250}, // Bb5
    {1047, 500}, // C6
    {932, 500}, // Bb5
    {831, 500}, // Ab5

    {0, 250},   // pause
};
int main(void) {
    configureFlash();
    configureClock();
    en15_16_APB();

    int i = 0;
    for(i=0; i<(sizeof(notes) / (2*sizeof(int))); i++) {
        PWM(notes[i][0]);
        wait(notes[i][1]);
      
    }  
     
    int j = 0;
    for(j=0; j<(sizeof(icecream)/ (2*sizeof(int))); j++) {
        PWM(icecream[j][0]);
        wait(icecream[j][1]);
    }
   
}
